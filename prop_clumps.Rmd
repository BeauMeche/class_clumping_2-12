---
title: "clumping hypothesis"
author: "Beau Meche"
date: "2/12/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
```

```{r}
num_men <- rep(0,14)
num_women <- rep(1,16)
class_1 <- seq(1, 7)
class_2 <- seq(7,8)

x = c(num_men,num_women)

reps = 10000

compositions <- vector("numeric", reps)

for (q in 1:reps) {
 
compositions[q] <- data.frame(gender = sample(x, 30),
                     table = c(rep(class_1, 4), 8,8)) %>% 
  group_by(table) %>% 
  summarize(num_women = sum(gender)) %>% 
  mutate(clumps = ifelse(num_women %in% c(0,4), yes = 1, no = 0)) %>% 
  summarise(prop_clumps = mean(clumps))
}

compositions <- data.frame(t(as.data.frame(compositions))*8, seq_along(t(as.data.frame(compositions))))

# plot here
mn <- mean(compositions)
ggplot()

```
We would expect a class of 14 men and 16 women to clump into about `r mn` single gender tables per class meeting, given 4 seats per table (except the last table, which has 2 seats.
